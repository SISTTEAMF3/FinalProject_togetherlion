<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.test.mybatis.IAdminDAO">
	
	<!-- 로그인 -->
	<select id="loginAdmin" resultType="java.lang.String">
		SELECT MEMBER_CODE 
		FROM ADMIN_INFO
		WHERE ID=#{id} AND PW=#{pw}
	</select>
	
	<!-- 관리자 검색 -->
	<select id="search" resultType="com.test.mybatis.AdminDTO">
		SELECT CODE, ID, PW, NAME, TEL, ADMIN_GRADE_CODE, MEMBER_CODE, PROFILE_PATH
		FROM ADMIN_INFO
		WHERE MEMBER_CODE=#{member_code}
	</select>
	
	<!-- 전체회원목록 -->
	<select id="listAllMember" resultType="com.test.mybatis.MemberDTO">
		SELECT ROWNUM, ID, NAME, NICKNAME, TEL, REPORTED_COUNT, DORMANT, REGIST_DATETIME 
		FROM VIEW_MEMBERLIST
		ORDER BY ROWNUM DESC
	</select>
	
	<!-- 전체회원목록 페이징처리 -->
	<select id="listAllMemberCount" resultType="java.lang.Integer">
		SELECT COUNT(*)
		FROM VIEW_MEMBERLIST
	</select>
	
	<!-- 공지사항 목록 -->
    <select id="listNotice" resultType="com.test.mybatis.AdNoticeListDTO">
        SELECT ROW_NUMBER() OVER(ORDER BY N.WRITE_DATETIME DESC) AS CODE
        , N.TITLE, AI.ID AS ADMIN_CODE, N.WRITE_DATETIME
         FROM NOTICE N LEFT JOIN ADMIN_INFO AI
        ON N.ADMIN_CODE = AI.MEMBER_CODE
    </select>

</mapper>
